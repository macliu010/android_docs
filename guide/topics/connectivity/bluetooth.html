<!DOCTYPE html>







































































<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico" />
<title>蓝牙 | Android Developers</title>

<!-- STYLESHEETS -->
<link rel="stylesheet"
href="http://fonts.googleapis.com/css?family=Roboto:regular,medium,thin,italic,mediumitalic,bold" title="roboto">
<link href="../../../assets/css/default.css" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script src="../../../assets/js/global-libraries-combined.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "../../../";
</script>
<script src="../../../assets/js/docs.js" type="text/javascript"></script>
<script src="../../../navtree_data.js" type="text/javascript"></script>

</head>
<body class="gc-documentation
  develop guide" itemscope itemtype="http://schema.org/Article">
<a name="top"></a>

    <!-- Header -->
    <div id="header">
        <div class="wrap" id="header-wrap">
          <div class="col-3 logo">
          <a href="../../../index.html">
            <img src="../../../assets/images/dac_logo.png" width="123" height="25" alt="Android Developers" />
          </a>
          <div class="btn-quicknav" id="btn-quicknav">
          	<a href="#" class="arrow-inactive">Quicknav</a>
			      <a href="#" class="arrow-active">Quicknav</a>
          </div>
          </div>
            <ul class="nav-x col-9">
                <li class="design">
                  <a href="../../../design/index.html" 
                  zh-TW-lang="設計"
                  zh-CN-lang="设计"
                  ru-lang="Проектирование"
                  ko-lang="디자인"
                  ja-lang="設計"
                  es-lang="Diseñar"               
                  >设计</a></li>
                <li class="develop"><a href="../../../develop/index.html" class="selected"
                  zh-TW-lang="開發"
                  zh-CN-lang="开发"
                  ru-lang="Разработка"
                  ko-lang="개발"
                  ja-lang="開発"
                  es-lang="Desarrollar"               
                  >开发</a></li>
                <li class="distribute last"><a href="../../../distribute/index.html" 
                  zh-TW-lang="發佈"
                  zh-CN-lang="分发"
                  ru-lang="Распространение"
                  ko-lang="배포"
                  ja-lang="配布"
                  es-lang="Distribuir"               
                  >分发</a></li>
            </ul>
            
            <!-- New Search -->
            <div class="menu-container">
            <div class="moremenu">
    <div id="more-btn"></div>
  </div>
  <div class="morehover" id="moremenu">
    <div class="top"></div>
    <div class="mid">
      <div class="header">Links</div>
      <ul>
        <li><a href="https://play.google.com/apps/publish/">Google Play Developer Console</a></li>
        <li><a href="http://android-developers.blogspot.com/">Android Developers Blog</a></li>
        <li><a href="../../../about/index.html">About Android</a></li>
      </ul>
      <div class="header">Android Sites</div>
      <ul>
        <li><a href="http://www.android.com">Android.com</a></li>
        <li class="active"><a>Android Developers</a></li>
        <li><a href="http://source.android.com">Android Open Source Project</a></li>
      </ul>
      <!-- <div class="header">Support</div>
      <ul>
        <li><a href="../../../support.html">Developer Support</a></li>
      </ul> -->
      <div class="header">Languages</div>
        <div id="language" class="locales">
          <select name="language" onChange="changeLangPref(this.value, true)">
              <option value="en">English</option>
              <option value="es">Español</option>
              <option value="ja">日本語</option>
              <option value="ko">한국어</option>
              <option value="ru">Русский</option>
              <option value="zh-CN">中文 (中国)</option>
              <option value="zh-TW">中文 (台灣)</option>
          </select>
        </div>
      <script type="text/javascript">
        <!--  
        loadLangPref();  
          //-->
      </script>
      <br class="clearfix" />
    </div>
    <div class="bottom"></div>
  </div>
  <div class="search" id="search-container">
    <div class="search-inner">
      <div id="search-btn"></div>
      <div class="left"></div>
      <form onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q"
onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)"
onkeydown="return search_changed(event, true, '../../../')" 
onkeyup="return search_changed(event, false, '../../../')" />
      </form>
      <div class="right"></div>
        <a class="close hide">close</a>
        <div class="left"></div>
        <div class="right"></div>
    </div>
  </div>
  <div id="search_filtered_wrapper">
    <div id="search_filtered_div" class="no-display">
        <ul id="search_filtered">
        </ul>
    </div>
  </div>
  
  </div>
  <!-- /New Search>
          
          
          <!-- Expanded quicknav -->
           <div id="quicknav" class="col-9">
                <ul>
                    <li class="design">
                      <ul>
                        <li><a href="../../../design/index.html">开始</a></li>
                        <li><a href="../../../design/style/index.html">Style</a></li>
                        <li><a href="../../../design/patterns/index.html">Patterns</a></li>
                        <li><a href="../../../design/building-blocks/index.html">Building Blocks</a></li>
                        <li><a href="../../../design/downloads/index.html">Downloads</a></li>
                        <li><a href="../../../design/videos/index.html">Videos</a></li>
                      </ul>
                    </li>
                    <li class="develop">
                      <ul>
                        <li><a href="../../../training/index.html"
                          zh-TW-lang="訓練課程"
                          zh-CN-lang="培训"
                          ru-lang="Курсы"
                          ko-lang="교육"
                          ja-lang="トレーニング"
                          es-lang="Capacitación"               
                          >训练</a></li>
                        <li><a href="../../../guide/components/index.html"
                          zh-TW-lang="API 指南"
                          zh-CN-lang="API 指南"
                          ru-lang="Руководства по API"
                          ko-lang="API 가이드"
                          ja-lang="API ガイド"
                          es-lang="Guías de la API"               
                          >API 指南</a></li>
                        <li><a href="../../../reference/packages.html"
                          zh-TW-lang="參考資源"
                          zh-CN-lang="参考"
                          ru-lang="Справочник"
                          ko-lang="참조문서"
                          ja-lang="リファレンス"
                          es-lang="Referencia"               
                          >参考</a></li>
                        <li><a href="../../../tools/index.html"
                          zh-TW-lang="相關工具"
                          zh-CN-lang="工具"
                          ru-lang="Инструменты"
                          ko-lang="도구"
                          ja-lang="ツール"
                          es-lang="Herramientas"               
                          >工具</a>
                          <ul><li><a href="../../../sdk/index.html">Get the
SDK</a></li></ul>
                        </li>
                      </ul>
                    </li>
                    <li class="distribute last">
                      <ul>
                        <li><a href="../../../distribute/index.html">Google Play</a></li>
                        <li><a href="../../../distribute/googleplay/publish/index.html">Publishing</a></li>
                        <li><a href="../../../distribute/googleplay/promote/index.html">Promoting</a></li>
                        <li><a href="../../../distribute/googleplay/quality/index.html">App Quality</a></li>
                        <li><a href="../../../distribute/googleplay/spotlight/index.html">Spotlight</a></li>
                        <li><a href="../../../distribute/open.html">Open Distribution</a></li>
                      </ul>
                    </li>
                </ul>
          </div>
          <!-- /Expanded quicknav -->
        </div>
    </div>
    <!-- /Header -->
    
    
  <div id="searchResults" class="wrap" style="display:none;">
          <h2 id="searchTitle">Results</h2>
          <div id="leftSearchControl" class="search-control">Loading...</div>
  </div>
    
    
    

    <!-- Secondary x-nav -->
    <div id="nav-x">
        <div class="wrap">
            <ul class="nav-x col-9 develop" style="width:75%">
                <li><a href="../../../training/index.html" 
                  zh-TW-lang="訓練課程"
                  zh-CN-lang="培训"
                  ru-lang="Курсы"
                  ko-lang="교육"
                  ja-lang="トレーニング"
                  es-lang="Capacitación"               
                  >训练</a></li>
                <li><a href="../../../guide/components/index.html" class="selected"
                  zh-TW-lang="API 指南"
                  zh-CN-lang="API 指南"
                  ru-lang="Руководства по API"
                  ko-lang="API 가이드"
                  ja-lang="API ガイド"
                  es-lang="Guías de la API"               
                  >API 指南</a></li>
                <li><a href="../../../reference/packages.html" 
                  zh-TW-lang="參考資源"
                  zh-CN-lang="参考"
                  ru-lang="Справочник"
                  ko-lang="참조문서"
                  ja-lang="リファレンス"
                  es-lang="Referencia"               
                  >参考</a></li>
                <li><a href="../../../tools/index.html" 
                  zh-TW-lang="相關工具"
                  zh-CN-lang="工具"
                  ru-lang="Инструменты"
                  ko-lang="도구"
                  ja-lang="ツール"
                  es-lang="Herramientas"               
                  >工具</a></li>
            </ul>
        </div>
        
    </div>
    <!-- /Sendondary x-nav -->

  

  <div class="wrap clearfix" id="body-content">
    <div class="col-4" id="side-nav" itemscope itemtype="http://schema.org/SiteNavigationElement">
      <div id="devdoc-nav" class="scroll-pane">
<a class="totop" href="#top" data-g-event="left-nav-top">to top</a>



<ul id="nav">
  <!--  Walkthrough for Developers -- quick overview of what it's like to develop on Android -->
  <!--<li style="color:red">概览</li> -->

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../../guide/components/index.html">
        <span class="en">应用组件</span>
      </a></div>
    <ul>
      <li><a href="../../../guide/components/fundamentals.html">
            <span class="en">应用基础</span></a>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/components/activities.html">
            <span class="en">Activities</span>
          </a></div>
        <ul>
          <li><a href="../../../guide/components/fragments.html">
              <span class="en">Fragments</span>
            </a></li>
          <li><a href="../../../guide/components/loaders.html">
              <span class="en">Loaders</span>
            </a></li>
          <li><a href="../../../guide/components/tasks-and-back-stack.html">
              <span class="en">任务和后退栈</span>
            </a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/components/services.html">
            <span class="en">Services</span>
          </a></div>
        <ul>
          <li><a href="../../../guide/components/bound-services.html">
              <span class="en">Bound Services</span>
            </a></li>
          <li><a href="../../../guide/components/aidl.html">
              <span class="en">AIDL</span>
            </a></li>
        </ul>
      </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/providers/content-providers.html">
            <span class="en">内容提供器</span>
          </a></div>
        <ul>
          <li><a href="../../../guide/topics/providers/content-provider-basics.html">
              <span class="en">Content Provider Basics</span>
            </a></li>
          <li><a href="../../../guide/topics/providers/content-provider-creating.html">
              <span class="en">Creating a Content Provider</span>
            </a></li>
          <li><a href="../../../guide/topics/providers/calendar-provider.html">
              <span class="en">Calendar Provider</span>
            </a></li>
          <li><a href="../../../guide/topics/providers/contacts-provider.html">
              <span class="en">Contacts Provider</span>
            </a></li>
        </ul>
      </li>
      <li><a href="../../../guide/components/intents-filters.html">
          <span class="en">Intents和Intent过滤器</span>
        </a></li>
      <li><a href="../../../guide/components/processes-and-threads.html">
          <span class="en">进程和线程</span>
        </a>
      </li>
      <li><a href="../../../guide/topics/security/permissions.html">
          <span class="en">权限体系</span>
        </a>
      </li>
      <li><a href="../../../guide/topics/appwidgets/index.html">
            <span class="en">应用小部件</span>
          </a></li>
      <li class="nav-section">
      <div class="nav-section-header"><a href="../../../guide/topics/manifest/manifest-intro.html">
          <span class="en">Android Manifest</span>
        </a></div>
        <ul>
          <li><a href="../../../guide/topics/manifest/action-element.html">&lt;action&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/activity-element.html">&lt;activity&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/activity-alias-element.html">&lt;activity-alias&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/application-element.html">&lt;application&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/category-element.html">&lt;category&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/compatible-screens-element.html">&lt;compatible-screens&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/data-element.html">&lt;data&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/grant-uri-permission-element.html">&lt;grant-uri-permission&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/instrumentation-element.html">&lt;instrumentation&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/intent-filter-element.html">&lt;intent-filter&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/manifest-element.html">&lt;manifest&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/meta-data-element.html">&lt;meta-data&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/path-permission-element.html">&lt;path-permission&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/permission-element.html">&lt;permission&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/permission-group-element.html">&lt;permission-group&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/permission-tree-element.html">&lt;permission-tree&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/provider-element.html">&lt;provider&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/receiver-element.html">&lt;receiver&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/service-element.html">&lt;service&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/supports-gl-texture-element.html">&lt;supports-gl-texture&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/supports-screens-element.html">&lt;supports-screens&gt;</a></li><!-- ##api level 4## -->
          <li><a href="../../../guide/topics/manifest/uses-configuration-element.html">&lt;uses-configuration&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/uses-feature-element.html">&lt;uses-feature&gt;</a></li> <!-- ##api level 4## -->
          <li><a href="../../../guide/topics/manifest/uses-library-element.html">&lt;uses-library&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/uses-permission-element.html">&lt;uses-permission&gt;</a></li>
          <li><a href="../../../guide/topics/manifest/uses-sdk-element.html">&lt;uses-sdk&gt;</a></li>
        </ul>
   </li><!-- end of the manifest file -->

    </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../../guide/topics/ui/index.html">
        <span class="en">用户界面</span>
      </a></div>
    <ul>
      <li><a href="../../../guide/topics/ui/overview.html">
          <span class="en">概览</span>
        </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/ui/declaring-layout.html">
            <span class="en">Layouts</span>
          </a></div>
        <ul>
          <li><a href="../../../guide/topics/ui/layout/linear.html">
              <span class="en">Linear Layout</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/layout/relative.html">
              <span class="en">Relative Layout</span>
            </a></li>
       <!--
          <li><a href="../../../guide/topics/ui/layout/grid.html">
              <span class="en">Grid Layout</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/layout/tabs.html">
              <span class="en">Tab Layout</span>
            </a></li>
       -->
          <li><a href="../../../guide/topics/ui/layout/listview.html">
              <span class="en">List View</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/layout/gridview.html">
              <span class="en">Grid View</span>
            </a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/ui/controls.html">
            <span class="en">Input Controls</span>
          </a></div>
        <ul>
          <li><a href="../../../guide/topics/ui/controls/button.html">
              <span class="en">Buttons</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/controls/text.html">
              <span class="en">Text Fields</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/controls/checkbox.html">
              <span class="en">Checkboxes</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/controls/radiobutton.html">
              <span class="en">Radio Buttons</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/controls/togglebutton.html">
              <span class="en">Toggle Buttons</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/controls/spinner.html">
              <span class="en">Spinners</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/controls/pickers.html">
              <span class="en">Pickers</span>
            </a></li>
<!--
          <li><a href="../../../guide/topics/ui/controls/progress.html">
              <span class="en">Seek and Progress Bars</span>
            </a></li>
-->
        </ul>
      </li>
      <li><a href="../../../guide/topics/ui/ui-events.html">
          <span class="en">Input Events</span>
        </a></li>
      <li><a href="../../../guide/topics/ui/menus.html">
          <span class="en">Menus</span></span>
          </a></li>
      <li><a href="../../../guide/topics/ui/actionbar.html">
           <span class="en">Action Bar</span>
          </a></li>
      <li><a href="../../../guide/topics/ui/settings.html">
            <span class="en">Settings</span>
          </a></li>
      <li><a href="../../../guide/topics/ui/dialogs.html">
           <span class="en">Dialogs</span>
          </a></li>
      <li><a href="../../../guide/topics/ui/notifiers/notifications.html">
          <span class="en">Notifications</span>
        </a></li>
      <li><a href="../../../guide/topics/ui/notifiers/toasts.html">
          <span class="en">Toasts</span>
        </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/search/index.html">
            <span class="en">Search</span>
          </a></div>
          <ul>
            <li><a href="../../../guide/topics/search/search-dialog.html">Creating a Search Interface</a></li>
            <li><a href="../../../guide/topics/search/adding-recent-query-suggestions.html">Adding Recent Query Suggestions</a></li>
            <li><a href="../../../guide/topics/search/adding-custom-suggestions.html">Adding Custom Suggestions</a></li>
            <li><a href="../../../guide/topics/search/searchable-config.html">Searchable Configuration</a></li>
          </ul>
      </li>
      <li><a href="../../../guide/topics/ui/drag-drop.html">
          <span class="en">拖放</span>
        </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/ui/accessibility/index.html">
            <span class="en">配件</span>
          </a></div>
        <ul>
          <li><a href="../../../guide/topics/ui/accessibility/apps.html">
              <span class="en">Making Applications Accessible</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/accessibility/checklist.html">
              <span class="en">Accessibility Developer Checklist</span>
            </a></li>
          <li><a href="../../../guide/topics/ui/accessibility/services.html">
              <span class="en">Building Accessibility Services</span>
            </a></li>
        </ul>
      </li>
      <li><a href="../../../guide/topics/ui/themes.html">
          <span class="en">样式和主题</span>
        </a></li>
      <li><a href="../../../guide/topics/ui/custom-components.html">
          <span class="en">自定义组件</span>
        </a></li>
    </ul>
  </li><!-- end of 用户界面 -->

    <li class="nav-section">
      <div class="nav-section-header"><a href="../../../guide/topics/resources/index.html">
           <span class="en">应用资源</span>
         </a></div>
      <ul>
        <li><a href="../../../guide/topics/resources/overview.html">
            <span class="en">概览</span>
          </a></li>
          <li><a href="../../../guide/topics/resources/providing-resources.html">
            <span class="en">资源提供</span>
          </a></li>
        <li><a href="../../../guide/topics/resources/accessing-resources.html">
            <span class="en">访问资源</span>
          </a></li>
        <li><a href="../../../guide/topics/resources/runtime-changes.html">
              <span class="en">处理运行时变化</span>
            </a></li>
        <li><a href="../../../guide/topics/resources/localization.html">
            <span class="en">本地化</span>
          </a></li>
        <li class="nav-section">
          <div class="nav-section-header"><a href="../../../guide/topics/resources/available-resources.html">
              <span class="en">资源类型</span>
            </a></div>
          <ul>
            <li><a href="../../../guide/topics/resources/animation-resource.html">Animation</a></li>
            <li><a href="../../../guide/topics/resources/color-list-resource.html">Color State List</a></li>
            <li><a href="../../../guide/topics/resources/drawable-resource.html">Drawable</a></li>
            <li><a href="../../../guide/topics/resources/layout-resource.html">Layout</a></li>
            <li><a href="../../../guide/topics/resources/menu-resource.html">Menu</a></li>
            <li><a href="../../../guide/topics/resources/string-resource.html">String</a></li>
            <li><a href="../../../guide/topics/resources/style-resource.html">Style</a></li>
            <li><a href="../../../guide/topics/resources/more-resources.html">More Types</a></li>
          </ul>
        </li><!-- end of resource types -->
      </ul>
    </li><!-- end of app resources -->

   <li class="nav-section">
      <div class="nav-section-header"><a href="../../../guide/topics/graphics/index.html">
          <span class="en">动画和图形</span>
        </a></div>
      <ul>
      <li class="nav-section">
        <li><a href="../../../guide/topics/graphics/overview.html">
            <span class="en">概览</span>
          </a></li>
        <li><a href="../../../guide/topics/graphics/prop-animation.html">
            <span class="en">Property Animation</span>
          </a></li>
        <li><a href="../../../guide/topics/graphics/view-animation.html">
            <span class="en">View Animation</span>
          </a></li>
        <li><a href="../../../guide/topics/graphics/drawable-animation.html">
            <span class="en">Drawable Animation</span>
          </a></li>
        <li><a href="../../../guide/topics/graphics/2d-graphics.html">
            <span class="en">Canvas and Drawables</span>
          </a></li>
        <li><a href="../../../guide/topics/graphics/opengl.html">
            <span class="en">OpenGL</span>
          </a></li>
        <li><a href="../../../guide/topics/graphics/hardware-accel.html">
            <span class="en">硬件加速</span>
          </a></li>
       </ul>
    </li><!-- end of graphics and animation-->

   <li class="nav-section">
            <div class="nav-section-header"><a href="../../../guide/topics/renderscript/index.html">
              <span class="en">计算</span>
            </a></div>
            <ul>
              <li><a href="../../../guide/topics/renderscript/compute.html">
                    <span class="en">Renderscript</span></a>
                  </li>

              <li><a href="../../../guide/topics/renderscript/advanced.html">
                    <span class="en">Advanced Renderscript</span></a>
                  </li>
              <li><a href="../../../guide/topics/renderscript/reference.html">
                    <span class="en">运行时API手册</span></a>
              </li>
             </ul>
   </li>
      <li class="nav-section">
          <div class="nav-section-header"><a href="../../../guide/topics/media/index.html">
            <span class="en">媒体和摄像头</span>
          </a></div>
          <ul>
            <li><a href="../../../guide/topics/media/mediaplayer.html">
                  <span class="en">播放媒体</span></a>
                </li>
            <li><a href="../../../guide/appendix/media-formats.html">
                   <span class="en">支持媒体类型</span></a>
                </li>
            <li><a href="../../../guide/topics/media/audio-capture.html">
                  <span class="en">捕获音频</span></a>
                </li>
            <li><a href="../../../guide/topics/media/jetplayer.html">
                  <span class="en">JetPlayer</span></a>
                </li>
            <li><a href="../../../guide/topics/media/camera.html">
                  <span class="en">相机</span></a>
                </li>
          </ul>
      </li><!-- end of media and camera -->

      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/sensors/index.html">
              <span class="en">定位和传感器</span>
              </a></div>
        <ul>
          <li><a href="../../../guide/topics/location/index.html">
               <span class="en">定位和地图</span>
             </a>
          <li><a href="../../../guide/topics/location/strategies.html">
               <span class="en">Location Strategies</span>
             </a></li>
          <li><a href="../../../guide/topics/sensors/sensors_overview.html">
              <span class="en">Sensors 概览</span>
            </a></li>
          <li><a href="../../../guide/topics/sensors/sensors_motion.html">
              <span class="en">动作传感器</span>
            </a></li>
          <li><a href="../../../guide/topics/sensors/sensors_position.html">
              <span class="en">位置传感器</span>
            </a></li>
          <li><a href="../../../guide/topics/sensors/sensors_environment.html">
              <span class="en">环境传感器</span>
            </a></li>
        </ul>
      </li><!-- end of location and sensors -->



      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/connectivity/index.html">
               <span class="en">链接</span>
             </a></div>
        <ul>
          <li><a href="../../../guide/topics/connectivity/bluetooth.html">
              <span class="en">蓝牙</span>
            </a>
          </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/connectivity/nfc/index.html">
          <span class="en">NFC</span></a>
        </div>
        <ul>
          <li><a href="../../../guide/topics/connectivity/nfc/nfc.html">NFC Basics</a></li>
          <li><a href="../../../guide/topics/connectivity/nfc/advanced-nfc.html">Advanced NFC</a></li>
        </ul>
      </li>
      <li><a href="../../../guide/topics/connectivity/wifip2p.html">
            <span class="en">Wi-Fi Direct</span></a>
          </li>
      <li class="nav-section">
          <div class="nav-section-header"><a href="../../../guide/topics/connectivity/usb/index.html">
            <span class="en">USB</span></a>
          </div>
            <ul>
              <li><a href="../../../guide/topics/connectivity/usb/accessory.html">Accessory</a></li>
              <li><a href="../../../guide/topics/connectivity/usb/host.html">Host</a></li>
            </ul>
     </li>
     <li><a href="../../../guide/topics/connectivity/sip.html">
            <span class="en">SIP</span>
          </a>
     </li>

    </ul>
  </li><!-- end of connectivity -->

      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/topics/text/index.html">
            <span class="en">文本和输入</span>
        </a></div>
        <ul>
          <li><a href="../../../guide/topics/text/copy-paste.html">
              <span class="en">Copy and Paste</span>
            </a></li>
          <li><a href="../../../guide/topics/text/creating-input-method.html">
              <span class="en">Creating an IME</span>
            </a></li>
          <li><a href="../../../guide/topics/text/spell-checker-framework.html">
              <span class="en">Spelling Checker</span>
            </a></li>
        </ul>
      </li><!-- end of text and input -->

     <li class="nav-section">
      <div class="nav-section-header"><a href="../../../guide/topics/data/index.html">
          <span class="en">数据存储</span>
        </a></div>
      <ul>
         <li><a href="../../../guide/topics/data/data-storage.html">
            <span class="en">Storage Options</span>
           </a></li>
        <li><a href="../../../guide/topics/data/backup.html">
            <span class="en">Data Backup</span>
          </a></li>
        <li><a href="../../../guide/topics/data/install-location.html">
            <span class="en">App Install Location</span>
          </a></li>
      </ul>
    </li><!-- end of data storage -->


  <li class="nav-section">
           <div class="nav-section-header"><a href="../../../guide/topics/admin/index.html">
               <span class="en">管理</span>
             </a></div>
           <ul>
              <li>
                <a href="../../../guide/topics/admin/device-admin.html">
                <span class="en">Device Policies</span></a>
              </li>
            <!--
              <li>
                <a href="../../../guide/topics/admin/keychain.html">
                <span class="en">Certificate Store</span></a>
              </li>
            -->
           </ul>
  </li><!-- end of administration -->

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../../guide/webapps/index.html">
    <span class="en">网页应用</span>
    </a></div>
    <ul>
      <li><a href="../../../guide/webapps/overview.html">
            <span class="en">概览</span>
          </a></li>
      <li><a href="../../../guide/webapps/targeting.html">
            <span class="en">Targeting Screens from 网页应用</span>
          </a></li>
      <li><a href="../../../guide/webapps/webview.html">
            <span class="en">在WebView中创建网页应用</span>
          </a></li>
      <li><a href="../../../guide/webapps/debugging.html">
            <span class="en">网页应用Debug</span>
          </a></li>
      <li><a href="../../../guide/webapps/best-practices.html">
            <span class="en">网页应用的最佳实践</span>
          </a></li>
    </ul>
  </li><!-- end of web apps -->

  <li class="nav-section">
    <div class="nav-section-header"><a href="../../../guide/practices/index.html">
      <span class="en">最佳实践</span>
      <span class="de" style="display:none">Bewährte Verfahren</span>
      <span class="es" style="display:none">Prácticas recomendadas</span>
      <span class="fr" style="display:none">Meilleures pratiques</span>
      <span class="it" style="display:none">Best practice</span>
      <span class="ja" style="display:none">ベスト プラクティス</span>
      <span class="zh-CN" style="display:none">最佳实践</span>
      <span class="zh-TW" style="display:none">最佳實務</span>
    </div></a>
    <ul>
      <li><a href="../../../guide/practices/compatibility.html">
            <span class="en">Compatibility</span>
          </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/practices/screens_support.html">
          <span class="en">Supporting Multiple Screens</span>
        </a></div>
        <ul>
          <li><a href="../../../guide/practices/screens-distribution.html">
            <span class="en">Distributing to Specific Screens</span>
          </a></li>
          <li><a href="../../../guide/practices/screen-compat-mode.html">
            <span class="en">Screen Compatibility Mode</span>
          </a></li>
          <!--<li><a href="../../../guide/practices/screens-support-1.5.html">
            <span class="en">Strategies for Android 1.5</span>
          </a></li> -->
        </ul>
      </li>
      <li><a href="../../../guide/practices/tablets-and-handsets.html">
            <span class="en">Supporting Tablets and Handsets</span>
          </a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/practices/performance.html">
            <span class="en">Designing for Performance</span>
          </a></div>
        <ul>
          <li><a href="../../../guide/practices/jni.html">
                <span class="en">JNI Tips</span>
              </a></li>
        </ul>
      </li>
      <li><a href="../../../guide/practices/responsiveness.html">
            <span class="en">Designing for Responsiveness</span>
          </a></li>
      <li><a href="../../../guide/practices/seamlessness.html">
            <span class="en">Designing for Seamlessness</span>
          </a></li>
        <li><a href="../../../guide/practices/security.html">
            <span class="en">Designing for Security</span>
          </a></li>

    </ul>
  </li>


  <li class="nav-section">
    <div class="nav-section-header"><a href="../../../guide/google/index.html">
        <span class="en">Google服务</span>
      </a></div>
    <ul>

      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/google/play/billing/index.html">
            <span class="en">In-app Billing</span></a>
        </div>
        <ul>
          <li><a href="../../../guide/google/play/billing/billing_overview.html">
              <span class="en">In-app Billing 概览</span></a>
          </li>
          <li><a href="../../../guide/google/play/billing/billing_integrate.html">
              <span class="en">Implementing In-app Billing</span></a>
          </li>
          <li><a href="../../../guide/google/play/billing/billing_subscriptions.html">
              <span class="en">Subscriptions</span></a>
          </li>
          <li><a href="../../../guide/google/play/billing/billing_best_practices.html">
              <span class="en">Security and Design</span></a>
          </li>
          <li><a href="../../../guide/google/play/billing/billing_testing.html">
              <span class="en">Testing In-app Billing</span></a>
          </li>
          <li><a href="../../../guide/google/play/billing/billing_admin.html">
              <span class="en">Administering In-app Billing</span></a>
          </li>
          <li><a href="../../../guide/google/play/billing/billing_reference.html">
              <span class="en">In-app Billing Reference</span></a>
          </li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/google/play/licensing/index.html">
          <span class="en">Application Licensing</span></a>
        </div>
        <ul>
          <li><a href="../../../guide/google/play/licensing/overview.html">
              <span class="en">Licensing 概览</span></a>
          </li>
          <li><a href="../../../guide/google/play/licensing/setting-up.html">
              <span class="en">Setting Up for Licensing</span></a>
          </li>
          <li><a href="../../../guide/google/play/licensing/adding-licensing.html">
              <span class="en">Adding Licensing to Your App</span></a>
          </li>
          <li><a href="../../../guide/google/play/licensing/licensing-reference.html">
              <span class="en">Licensing Reference</span></a>
          </li>
        </ul>
      </li>
      <li><a href="../../../guide/google/play/services.html">
          <span class="en">Google Play Services</span></a>
      </li>
       <li><a href="../../../guide/google/play/filters.html">
          <span class="en">Filters on Google Play</span></a>
      </li>
      <li><a href="../../../guide/google/play/publishing/multiple-apks.html">
          <span class="en">Multiple APK Support</span></a>
      </li>
      <li><a href="../../../guide/google/play/expansion-files.html">
          <span class="en">APK Expansion Files</span></a>
      </li>

      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/google/gcm/index.html">
          <span class="en">Google Cloud Messaging</span></a>
        </div>
        <ul>
          <li><a href="../../../guide/google/gcm/gs.html">
              <span class="en">Getting Started</span></a>
          </li>
          <li><a href="../../../guide/google/gcm/gcm.html">
              <span class="en">Architectural 概览</span></a>
          </li>
          <li><a href="../../../guide/google/gcm/demo.html">
              <span class="en">Demo App Tutorial</span></a>
          </li>
          <li><a href="../../../guide/google/gcm/adv.html">
              <span class="en">Advanced Topics</span></a>
          </li>
          <li><a href="../../../guide/google/gcm/c2dm.html">
              <span class="en">Migration</span></a>
          </li>
        </ul>
      </li>

    </ul>
  </li><!-- end Google Play -->



      <!-- this needs to move
      <li class="nav-section">
        <div class="nav-section-header"><a href="../../../guide/practices/ui_guidelines/index.html">
               <span class="en">UI Guidelines</span>
             </a></div>
        <ul>
          <li class="nav-section">
            <div class="nav-section-header"><a href="../../../guide/practices/ui_guidelines/icon_design.html">
                   <span class="en">Icon Design</span>
                 </a></div>
            <ul>
              <li><a href="../../../guide/practices/ui_guidelines/icon_design_launcher.html">
                    <span class="en">Launcher Icons</span>
                  </a></li>
              <li><a href="../../../guide/practices/ui_guidelines/icon_design_menu.html">
                    <span class="en">Menu Icons</span>
                  </a></li>
              <li><a href="../../../guide/practices/ui_guidelines/icon_design_action_bar.html">
                    <span class="en">Action Bar Icons</span>
                  </a></li>
              <li><a href="../../../guide/practices/ui_guidelines/icon_design_status_bar.html">
                    <span class="en">Status Bar Icons</span>
                  </a></li>
              <li><a href="../../../guide/practices/ui_guidelines/icon_design_tab.html">
                    <span class="en">Tab Icons</span>
                  </a></li>
              <li><a href="../../../guide/practices/ui_guidelines/icon_design_dialog.html">
                    <span class="en">Dialog Icons</span>
                  </a></li>
              <li><a href="../../../guide/practices/ui_guidelines/icon_design_list.html">
                    <span class="en">List View Icons</span>
                  </a></li>
            </ul>
          </li>
          <li><div><a href="../../../guide/practices/ui_guidelines/widget_design.html">
                <span class="en">App Widget Design</span>
              </a></div>
          </li>
        </ul>
      </li>
        </ul> -->

<!-- Remove
  <li class="nav-section">
    <div class="nav-section-header"><a href="../../../guide/appendix/index.html">
        <span class="en">Appendix</span>
        <span class="de" style="display:none">Anhang</span>
        <span class="es" style="display:none">Apéndice</span>
        <span class="fr" style="display:none">Annexes</span>
        <span class="it" style="display:none">Appendice</span>
        <span class="ja" style="display:none">付録</span>
        <span class="zh-CN" style="display:none">附录</span>
        <span class="zh-TW" style="display:none">附錄</span>
      </a></div>
    <ul>
      <li><a href="../../../guide/appendix/g-app-intents.html">
            <span class="en">Intents List: Google Apps</span>
          </a></li>


      <li><a href="../../../guide/appendix/glossary.html">
            <span class="en">Glossary</span>
          </a></li>
    </ul>
  </li>

</li>
-->
</ul>


<script type="text/javascript">
<!--
    buildToggleLists();
    changeNavLang(getLangPref());
//-->
</script>


        

      </div>
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>

    <script>
      $(document).ready(function() {
        changeDocLang(getLangPref());
        });
    </script>



<div class="col-12" id="doc-col" >


  
    
      <h1 itemprop="name">蓝牙</h1>
    
  


  
  <div id="jd-content">


    <div class="jd-descr" itemprop="articleBody">
    <div id="qv-wrapper"> 
<div id="qv"> 
 
  <h2>Quickview</h2> 
  <ul> 
    <li>Android's bluetooth APIs allow your application to perform wireless data transactions with
other devices</li> 
  </ul> 
 
  <h2>In this document</h2> 
  <ol> 
    <li><a href="#TheBasics">The Basics</a></li> 
    <li><a href="#权限体系">蓝牙 权限体系</a></li> 
    <li><a href="#SettingUp">Setting Up 蓝牙</a></li> 
    <li><a href="#FindingDevices">Finding Devices</a> 
      <ol> 
        <li><a href="#QueryingPairedDevices">Querying paired devices</a></li> 
        <li><a href="#DiscoveringDevices">Discovering devices</a></li> 
      </ol></li> 
    <li><a href="#ConnectingDevices">Connecting Devices</a> 
      <ol> 
        <li><a href="#ConnectingAsAServer">Connecting as a server</a></li> 
        <li><a href="#ConnectingAsAClient">Connecting as a client</a></li> 
      </ol></li> 
    <li><a href="#ManagingAConnection">Managing a Connection</a></li>
    <li><a href="#Profiles">Working with Profiles</a> 
      <ol>
        <li><a href="#AT-Commands">Vendor-specific AT commands</a>
        <li><a href="#HDP">Health Device Profile</a>
      </ol></li>
  </ol> 
 
  <h2>Key classes</h2> 
  <ol> 
    <li><code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code></li> 
    <li><code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code></li> 
    <li><code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code></li> 
    <li><code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code></li> 
  </ol> 
 
  <h2>Related samples</h2> 
  <ol> 
    <li><a href="../../../resources/samples/蓝牙Chat/index.html">蓝牙 Chat</a></li> 
    <li><a href="../../../resources/samples/蓝牙HDP/index.html">蓝牙 HDP (Health Device Profile)</a></li>
  </ol> 
 
</div> 
</div> 
 
 
<p>The Android platform includes support for the 蓝牙 network stack,
which allows a device to wirelessly exchange data with other 蓝牙 devices.
The application framework provides access to the 蓝牙 functionality through
the Android 蓝牙 APIs. These APIs let applications wirelessly
connect to other 蓝牙 devices, enabling point-to-point and multipoint
wireless features.</p> 
 
<p>Using the 蓝牙 APIs, an Android application can perform the
following:</p>
<ul>
  <li>Scan for other 蓝牙 devices</li>
  <li>Query the local 蓝牙 adapter for paired 蓝牙 devices</li>
  <li>Establish RFCOMM channels</li>
  <li>Connect to other devices through service discovery</li>
  <li>Transfer data to and from other devices</li>
  <li>Manage multiple connections</li>
</ul>


<h2 id="TheBasics">The Basics</h2>

<p>This document describes how to use the Android 蓝牙 APIs to accomplish
the four major tasks necessary to communicate using 蓝牙: setting up
蓝牙, finding devices that are either paired or available in the local
area, connecting devices, and transferring data between devices.</p> 
 
<p>All of the 蓝牙 APIs are available in the <code><a href="../../../reference/android/bluetooth/package-summary.html">android.bluetooth</a></code>
package. Here's a summary of the classes and interfaces you will need to create 蓝牙
connections:</p> 
 
<dl> 
<dt><code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code></dt> 
<dd>Represents the local 蓝牙 adapter (蓝牙 radio). The
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code> is the entry-point for all 蓝牙
interaction. Using this,
you can discover other 蓝牙 devices, query a list of bonded (paired)
devices, instantiate a <code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code> using a known
MAC address, and create a <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> to
listen for communications
from other devices.</dd> 
 
<dt><code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code></dt> 
<dd>Represents a remote 蓝牙 device. Use this to request a connection
with a remote device through a <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> or
query information about the
device such as its name, address, class, and bonding state.</dd> 
 
<dt><code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code></dt> 
<dd>Represents the interface for a 蓝牙 socket (similar to a TCP
<code><a href="../../../reference/java/net/Socket.html">Socket</a></code>). This is the connection point that allows
an application to exchange data with another 蓝牙 device via InputStream
and OutputStream.</dd> 
 
<dt><code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code></dt> 
<dd>Represents an open server socket that listens for incoming requests
(similar to a TCP <code><a href="../../../reference/java/net/ServerSocket.html">ServerSocket</a></code>). In order to connect two
Android devices, one device must open a server socket with this class. When a
remote 蓝牙 device makes a connection request to the this device, the
<code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> will return a connected <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> when the
connection is accepted.</dd> 
 
<dt><code><a href="../../../reference/android/bluetooth/蓝牙Class.html">蓝牙Class</a></code></dt> 
<dd>Describes the general characteristics and capabilities of a 蓝牙
device. This is a read-only set of properties that define the device's major and
minor device classes and its services. However, this does not reliably describe
all 蓝牙 profiles and services supported by the device, but is useful as a
hint to the device type.</dd> 
 
<dt><code><a href="../../../reference/android/bluetooth/蓝牙Profile.html">蓝牙Profile</a></code></dt> <dd>An interface that
represents a 蓝牙 profile. A <em>蓝牙 profile</em> is a wireless
interface specification for 蓝牙-based communication between devices. An
example is the Hands-Free profile.  For more discussion of profiles, see <a
href="#Profiles">Working with Profiles</a></dd> 

<dt><code><a href="../../../reference/android/bluetooth/蓝牙Headset.html">蓝牙Headset</a></code></dt> <dd>Provides support for
蓝牙 headsets to be used with mobile phones. This includes both  蓝牙
Headset and Hands-Free (v1.5) profiles.</dd> 

<dt><code><a href="../../../reference/android/bluetooth/蓝牙A2dp.html">蓝牙A2dp</a></code></dt> <dd> Defines how high quality
audio can be streamed from one device to another over a 蓝牙 connection.
"A2DP" stands for Advanced Audio Distribution Profile.</dd> 

<dt><code><a href="../../../reference/android/bluetooth/蓝牙Health.html">蓝牙Health</a></code></dt>
<dd> Represents a Health Device Profile proxy that controls the 蓝牙 service.</dd>

<dt><code><a href="../../../reference/android/bluetooth/蓝牙HealthCallback.html">蓝牙HealthCallback</a></code></dt>

<dd>An abstract class that you use to implement <code><a href="../../../reference/android/bluetooth/蓝牙Health.html">蓝牙Health</a></code> callbacks. You must extend this class and
implement the callback methods to receive updates about changes in the
application’s registration state and 蓝牙 channel state.</dd>

<dt><code><a href="../../../reference/android/bluetooth/蓝牙HealthAppConfiguration.html">蓝牙HealthAppConfiguration</a></code></dt>

<dd>Represents an application configuration that the 蓝牙 Health third-party 
application registers to communicate with a remote 蓝牙 health
device.</dd> 

<dt><code><a href="../../../reference/android/bluetooth/蓝牙Profile.ServiceListener.html">蓝牙Profile.ServiceListener</a></code></dt>

<dd>An interface that notifies <code><a href="../../../reference/android/bluetooth/蓝牙Profile.html">蓝牙Profile</a></code> IPC
clients when they have  been connected to or disconnected from the service (that
is, the internal service that runs a particular profile). </dd>
 
</dl> 
 
 
 
 
<h2 id="权限体系">蓝牙 权限体系</h2> 
 
<p>In order to use 蓝牙 features in your application, you need to declare
at least one of two 蓝牙 permissions: <code><a href="../../../reference/android/Manifest.permission.html#BLUETOOTH">BLUETOOTH</a></code> and <code><a href="../../../reference/android/Manifest.permission.html#BLUETOOTH_ADMIN">BLUETOOTH_ADMIN</a></code>.</p> 
 
<p>You must request the <code><a href="../../../reference/android/Manifest.permission.html#BLUETOOTH">BLUETOOTH</a></code> permission
in order to perform any 蓝牙 communication, such as requesting a
connection, accepting a connection, and transferring data.</p> 
 
<p>You must request the <code><a href="../../../reference/android/Manifest.permission.html#BLUETOOTH_ADMIN">BLUETOOTH_ADMIN</a></code>
permission in order to initiate device discovery or manipulate 蓝牙
settings. Most applications need this permission solely for the
ability to discover local 蓝牙 devices. The other abilities granted by this
permission should not be used, unless the application is a "power manager" that
will modify 蓝牙 settings upon user request. <strong>Note:</strong> If you
use <code><a href="../../../reference/android/Manifest.permission.html#BLUETOOTH_ADMIN">BLUETOOTH_ADMIN</a></code> permission, then must
also have the <code><a href="../../../reference/android/Manifest.permission.html#BLUETOOTH">BLUETOOTH</a></code> permission.</p> 
 
<p>Declare the 蓝牙 permission(s) in your application manifest file. For
example:</p> 
 
<pre> 
&lt;manifest ... >
  &lt;uses-permission android:name="android.permission.BLUETOOTH" />
  ...
&lt;/manifest>
</pre> 
 
<p>See the <a
href="../../../guide/topics/manifest/uses-permission-element.html">&lt;uses-permission></a> 
reference for more information about declaring application permissions.</p> 
 
 
<h2 id="SettingUp">Setting Up 蓝牙</h2> 
 
<div class="figure" style="width:200px"> 
<img src="../../../images/bt_enable_request.png" /> 
<strong>Figure 1:</strong> The enabling 蓝牙 dialog.
</div> 
 
<p>Before your application can communicate over 蓝牙, you need to verify
that 蓝牙 is supported on the device, and if so, ensure that it is enabled.</p> 
 
<p>If 蓝牙 is not supported, then you should gracefully disable any
蓝牙 features. If 蓝牙 is supported, but disabled, then you can request that the
user enable 蓝牙 without leaving your application. This setup is
accomplished in two steps, using the <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code>.</p> 
 
 
<ol> 
<li>Get the <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code>
<p>The <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code> is required for any and all 蓝牙
activity. To get the <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code>, call the static <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#getDefaultAdapter()">getDefaultAdapter()</a></code> method. This returns a
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code> that represents the device's own
蓝牙 adapter (the 蓝牙 radio). There's one 蓝牙 adapter for the
entire system, and your application can interact with it using this object. If
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#getDefaultAdapter()">getDefaultAdapter()</a></code> returns null,
then the device does not support 蓝牙 and your story ends here. For example:</p> 
<pre> 
蓝牙Adapter m蓝牙Adapter = 蓝牙Adapter.getDefaultAdapter();
if (m蓝牙Adapter == null) {
    // Device does not support 蓝牙
}
</pre> 
</li> 
 
<li>Enable 蓝牙
<p>Next, you need to ensure that 蓝牙 is enabled. Call <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#isEnabled()">isEnabled()</a></code> to check whether 蓝牙 is
currently enable. If this method returns false, then 蓝牙 is disabled. To
request that 蓝牙 be enabled, call <code><a href="../../../reference/android/app/Activity.html#startActivityForResult(android.content.Intent, int)">startActivityForResult()</a></code>
with the <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#ACTION_REQUEST_ENABLE">ACTION_REQUEST_ENABLE</a></code> action Intent.
This will issue a request to enable 蓝牙 through the system settings (without
stopping your application). For example:</p> 
<pre> 
if (!m蓝牙Adapter.isEnabled()) {
    Intent enableBtIntent = new Intent(蓝牙Adapter.ACTION_REQUEST_ENABLE);
    startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT);
}
</pre> 
 
<p>A dialog will appear requesting user permission to enable 蓝牙, as shown
in Figure 1. If the user responds "Yes," the system will begin to enable 蓝牙
and focus will return to your application once the process completes (or fails).</p> 

<p>The <code>REQUEST_ENABLE_BT</code> constant passed to <code><a href="../../../reference/android/app/Activity.html#startActivityForResult(android.content.Intent, int)">startActivityForResult()</a></code> is a locally
defined integer (which must be greater than 0), that the system passes back to you in your
<code><a href="../../../reference/android/app/Activity.html#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code> implementation as the
<code>requestCode</code> parameter.</p>

<p>If enabling 蓝牙 succeeds, your activity receives the <code><a href="../../../reference/android/app/Activity.html#RESULT_OK">RESULT_OK</a></code> result code in the <code><a href="../../../reference/android/app/Activity.html#onActivityResult(int, int, android.content.Intent)">onActivityResult()</a></code>
callback. If 蓝牙 was not enabled
due to an error (or the user responded "No") then the result code is <code><a href="../../../reference/android/app/Activity.html#RESULT_CANCELED">RESULT_CANCELED</a></code>.</p>
</li> 
</ol> 
 
<p>Optionally, your application can also listen for the
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#ACTION_STATE_CHANGED">ACTION_STATE_CHANGED</a></code> broadcast Intent, which
the system will broadcast whenever the 蓝牙 state has changed. This broadcast contains
the extra fields <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#EXTRA_STATE">EXTRA_STATE</a></code> and <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#EXTRA_PREVIOUS_STATE">EXTRA_PREVIOUS_STATE</a></code>, containing the new and old
蓝牙 states, respectively. Possible values for these extra fields are
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#STATE_TURNING_ON">STATE_TURNING_ON</a></code>, <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#STATE_ON">STATE_ON</a></code>, <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#STATE_TURNING_OFF">STATE_TURNING_OFF</a></code>, and <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#STATE_OFF">STATE_OFF</a></code>. Listening for this
broadcast can be useful to detect changes made to the 蓝牙 state while your
app is running.</p> 
 
<p class="note"><strong>Tip:</strong> Enabling discoverability will automatically
enable 蓝牙. If you plan to consistently enable device discoverability before
performing 蓝牙 activity, you can skip
step 2 above. Read about <a href="#EnablingDiscoverability">enabling discoverability</a>,
below.</p> 
 
 
<h2 id="FindingDevices">Finding Devices</h2> 
 
<p>Using the <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html">蓝牙Adapter</a></code>, you can find remote 蓝牙
devices either through device discovery or by querying the list of paired (bonded)
devices.</p> 
 
<p>Device discovery is a scanning procedure that searches the local area for
蓝牙 enabled devices and then requesting some information about each one
(this is sometimes referred to as "discovering," "inquiring" or "scanning").
However, a 蓝牙 device within the local area will respond to a discovery
request only if it is currently enabled to be discoverable. If a device is
discoverable, it will respond to the discovery request by sharing some
information, such as the device name, class, and its unique MAC address. Using
this information, the device performing discovery can then choose to initiate a
connection to the discovered device.</p> 
 
<p>Once a connection is made with a remote device for the first time, a pairing
request is automatically presented to the user. When a device is
paired, the basic information about that device (such as the device name, class,
and MAC address) is saved and can be read using the 蓝牙 APIs. Using the
known MAC address for a remote device, a connection can be initiated with it at
any time without performing discovery (assuming the device is within range).</p> 
 
<p>Remember there is a difference between being paired and being connected. To
be paired means that two devices are aware of each other's existence, have a
shared link-key that can be used for authentication, and are capable of
establishing an encrypted connection with each other. To be connected means that
the devices currently share an RFCOMM channel and are able to transmit data with
each other. The current Android 蓝牙 API's require devices to be paired
before an RFCOMM connection can be established. (Pairing is automatically performed
when you initiate an encrypted connection with the 蓝牙 APIs.)</p> 
 
<p>The following sections describe how to find devices that have been paired, or
discover new devices using device discovery.</p> 
 
<p class="note"><strong>Note:</strong> Android-powered devices are not
discoverable by default. A user can make
the device discoverable for a limited time through the system settings, or an
application can request that the user enable discoverability without leaving the
application. How to <a href="#EnablingDiscoverability">enable discoverability</a> 
is discussed below.</p> 
 
 
<h3 id="QueryingPairedDevices">Querying paired devices</h3> 
 
<p>Before performing device discovery, its worth querying the set
of paired devices to see if the desired device is already known. To do so,
call <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#getBondedDevices()">getBondedDevices()</a></code>. This
will return a Set of <code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code>s representing
paired devices. For example, you can query all paired devices and then
show the name of each device to the user, using an ArrayAdapter:</p> 
<pre> 
Set&lt;蓝牙Device> pairedDevices = m蓝牙Adapter.getBondedDevices();
// If there are paired devices
if (pairedDevices.size() > 0) {
    // Loop through paired devices
    for (蓝牙Device device : pairedDevices) {
        // Add the name and address to an array adapter to show in a ListView
        mArrayAdapter.add(device.getName() + "\n" + device.getAddress());
    }
}
</pre> 
 
<p>All that's needed from the <code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code> object
in order to initiate a connection is the MAC address. In this example, it's saved
as a part of an ArrayAdapter that's shown to the user. The MAC address can later
be extracted in order to initiate the connection. You can learn more about creating
a connection in the section about <a href="#ConnectingDevices">Connecting Devices</a>.</p> 
 
 
<h3 id="DiscoveringDevices">Discovering devices</h3> 
 
<p>To start discovering devices, simply call <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#startDiscovery()">startDiscovery()</a></code>. The
process is asynchronous and the method will immediately return with a boolean
indicating whether discovery has successfully started. The discovery process
usually involves an inquiry scan of about 12 seconds, followed by a page scan of
each found device to retrieve its 蓝牙 name.</p> 
 
<p>Your application must register a BroadcastReceiver for the
<code><a href="../../../reference/android/bluetooth/蓝牙Device.html#ACTION_FOUND">ACTION_FOUND</a></code> Intent in
order to receive information about each
device discovered. For each device, the system will broadcast the
<code><a href="../../../reference/android/bluetooth/蓝牙Device.html#ACTION_FOUND">ACTION_FOUND</a></code> Intent. This
Intent carries the extra fields
<code><a href="../../../reference/android/bluetooth/蓝牙Device.html#EXTRA_DEVICE">EXTRA_DEVICE</a></code> and
<code><a href="../../../reference/android/bluetooth/蓝牙Device.html#EXTRA_CLASS">EXTRA_CLASS</a></code>, containing a
<code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code> and a <code><a href="../../../reference/android/bluetooth/蓝牙Class.html">蓝牙Class</a></code>, respectively. For example, here's how you can
register to handle the broadcast when devices are discovered:</p> 
<pre> 
// Create a BroadcastReceiver for ACTION_FOUND
private final BroadcastReceiver mReceiver = new BroadcastReceiver() {
    public void onReceive(Context context, Intent intent) {
        String action = intent.getAction();
        // When discovery finds a device
        if (蓝牙Device.ACTION_FOUND.equals(action)) {
            // Get the 蓝牙Device object from the Intent
            蓝牙Device device = intent.getParcelableExtra(蓝牙Device.EXTRA_DEVICE);
            // Add the name and address to an array adapter to show in a ListView
            mArrayAdapter.add(device.getName() + "\n" + device.getAddress());
        }
    }
};
// Register the BroadcastReceiver
IntentFilter filter = new IntentFilter(蓝牙Device.ACTION_FOUND);
registerReceiver(mReceiver, filter); // Don't forget to unregister during onDestroy
</pre> 
 
<p>All that's needed from the <code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code> object
in order to initiate a
connection is the MAC address. In this example, it's saved as a part of an
ArrayAdapter that's shown to the user. The MAC address can later be extracted in
order to initiate the connection. You can learn more about creating a connection
in the section about <a href="#ConnectingDevices">Connecting Devices</a>.</p> 
 
<p class="caution"><strong>Caution:</strong> Performing device discovery is
a heavy procedure for the 蓝牙
adapter and will consume a lot of its resources. Once you have found a device to
connect, be certain that you always stop discovery with
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#cancelDiscovery()">cancelDiscovery()</a></code> before
attempting a connection. Also, if you
already hold a connection with a device, then performing discovery can
significantly reduce the bandwidth available for the connection, so you should
not perform discovery while connected.</p> 
 
<h4 id="EnablingDiscoverability">Enabling discoverability</h4> 
 
<p>If you would like to make the local device discoverable to other devices,
call <code><a href="../../../reference/android/app/Activity.html#startActivityForResult(android.content.Intent, int)">startActivityForResult(Intent, int)</a></code> with the
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#ACTION_REQUEST_DISCOVERABLE">ACTION_REQUEST_DISCOVERABLE</a></code> action
Intent. This will issue a request to enable discoverable mode through the system
settings (without stopping your application). By default, the device will become
discoverable for 120 seconds. You can define a different duration by adding the
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#EXTRA_DISCOVERABLE_DURATION">EXTRA_DISCOVERABLE_DURATION</a></code> Intent
extra. The maximum duration an app can set is 3600 seconds, and a value of 0
means the device is always discoverable. Any value below 0 or above 3600 is
automatically set to 120 secs). For example, this snippet sets the duration to
300:</p> 

<pre>Intent discoverableIntent = new
Intent(蓝牙Adapter.ACTION_REQUEST_DISCOVERABLE);
discoverableIntent.putExtra(蓝牙Adapter.EXTRA_DISCOVERABLE_DURATION, 300);
startActivity(discoverableIntent);
</pre> 
 
<div class="figure" style="width:200px"> 
<img src="../../../images/bt_enable_discoverable.png" /> 
<strong>Figure 2:</strong> The enabling discoverability dialog.
</div> 
 
<p>A dialog will be displayed, requesting user permission to make the device
discoverable, as shown in Figure 2. If the user responds "Yes," then the device
will become discoverable for the specified amount of time. Your activity will
then receive a call to the <code><a href="../../../reference/android/app/Activity.html#onActivityResult(int, int, android.content.Intent)">onActivityResult())</a></code> callback, with the result code equal to the duration that the device
is discoverable. If the user responded "No" or if an error occurred, the result code will
be <code><a href="../../../reference/android/app/Activity.html#RESULT_CANCELED">RESULT_CANCELED</a></code>.</p> 
 
<p class="note"><strong>Note:</strong> If 蓝牙 has not been enabled on the device,
then enabling device discoverability will automatically enable 蓝牙.</p> 
 
<p>The device will silently remain in discoverable mode for the allotted time.
If you would like to be notified when the discoverable mode has changed, you can
register a BroadcastReceiver for the <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#ACTION_SCAN_MODE_CHANGED">ACTION_SCAN_MODE_CHANGED</a></code>
Intent. This will contain the extra fields <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#EXTRA_SCAN_MODE">EXTRA_SCAN_MODE</a></code> and
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#EXTRA_PREVIOUS_SCAN_MODE">EXTRA_PREVIOUS_SCAN_MODE</a></code>, which tell you the
new and old scan mode, respectively. Possible values for each are
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#SCAN_MODE_CONNECTABLE_DISCOVERABLE">SCAN_MODE_CONNECTABLE_DISCOVERABLE</a></code>,
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#SCAN_MODE_CONNECTABLE">SCAN_MODE_CONNECTABLE</a></code>, or <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#SCAN_MODE_NONE">SCAN_MODE_NONE</a></code>,
which indicate that the device is either in discoverable mode, not in
discoverable mode but still able to receive connections, or not in discoverable
mode and unable to receive connections, respectively.</p> 
 
<p>You do not need to enable device discoverability if you will be initiating
the connection to a remote device. Enabling discoverability is only necessary when
you want your application to host a server socket that will accept incoming
connections, because the remote devices must be able to discover the device
before it can initiate the connection.</p> 
 
 
 
<h2 id="ConnectingDevices">Connecting Devices</h2> 
 
<p>In order to create a connection between your application on two devices, you
must implement both the server-side and client-side mechanisms, because one
device must open a server socket and the other one must initiate the connection
(using the server device's MAC address to initiate a connection). The server and
client are considered connected to each other when they each have a connected
<code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> on the same RFCOMM channel. At this
point, each device can obtain input and output streams and data transfer can
begin, which is discussed in the section about <a
href="#ManagingAConnection">Managing a Connection</a>. This section describes how
to initiate the connection between two devices.</p> 
 
<p>The server device and the client device each obtain the required <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> in different ways. The server will receive it
when an incoming connection is accepted. The client will receive it when it
opens an RFCOMM channel to the server.</p> 
 
<div class="figure" style="width:200px"> 
<img src="../../../images/bt_pairing_request.png" /> 
<strong>Figure 3:</strong> The 蓝牙 pairing dialog.
</div> 
 
<p>One implementation technique is to automatically prepare each device as a
server, so that each one has a server socket open and listening for connections.
Then either device can initiate a connection with the other and become the
client. Alternatively, one device can explicitly "host" the connection and open
a server socket on demand and the other device can simply initiate the
connection.</p> 
 
<p class="note"><strong>Note:</strong> If the two devices have not been previously paired,
then the Android framework will automatically show a pairing request notification or
dialog to the user during the connection procedure, as shown in Figure 3. So
when attempting to connect devices,
your application does not need to be concerned about whether or not the devices are
paired. Your RFCOMM connection attempt will block until the user has successfully paired,
or will fail if the user rejects pairing, or if pairing fails or times out. </p> 
 
 
<h3 id="ConnectingAsAServer">Connecting as a server</h3> 
 
<p>When you want to connect two devices, one must act as a server by holding an
open <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code>. The purpose of the server
socket is to listen for incoming connection requests and when one is accepted,
provide a connected <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>. When the <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> is acquired from the <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code>,
the <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> can (and should) be
discarded, unless you want to accept more connections.</p> 
 
<div class="sidebox-wrapper"> 
<div class="sidebox"> 
<h2>About UUID</h2> 
 
<p>A Universally Unique Identifier (UUID) is a standardized 128-bit format for a string
ID used to uniquely identify information. The point of a UUID is that it's big
enough that you can select any random and it won't clash. In this case, it's
used to uniquely identify your application's 蓝牙 service. To get a UUID to
use with your application, you can use one of the many random UUID generators on
the web, then initialize a <code><a href="../../../reference/java/util/UUID.html">UUID</a></code> with <code><a href="../../../reference/java/util/UUID.html#fromString(java.lang.String)">fromString(String)</a></code>.</p> 
</div> 
</div> 
 
<p>Here's the basic procedure to set up a server socket and accept a
connection:</p> 
 
<ol> 
<li>Get a <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> by calling the
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#listenUsingRfcommWithServiceRecord(java.lang.String, java.util.UUID)">listenUsingRfcommWithServiceRecord(String, UUID)</a></code>.
<p>The string is an identifiable name of your service, which the system will
automatically write to a new Service Discovery Protocol (SDP) database entry on
the device (the name is arbitrary and can simply be your application name). The
UUID is also included in the SDP entry and will be the basis for the connection
agreement with the client device. That is, when the client attempts to connect
with this device, it will carry a UUID that uniquely identifies the service with
which it wants to connect. These UUIDs must match in order for the connection to
be accepted (in the next step).</p> 
</li> 
 
<li>Start listening for connection requests by calling
<code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#accept()">accept()</a></code>.
<p>This is a blocking call. It will return when either a connection has been
accepted or an exception has occurred. A connection is accepted only when a
remote device has sent a connection request with a UUID matching the one
registered with this listening server socket. When successful, <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#accept()">accept()</a></code> will
return a connected <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>.</p> 
</li> 
 
<li>Unless you want to accept additional connections, call
<code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#close()">close()</a></code>.
<p>This releases the server socket and all its resources, but does <em>not</em> close the
connected <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> that's been returned by <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#accept()">accept()</a></code>. Unlike TCP/IP, RFCOMM only allows one
connected client per channel at a time, so in most cases it makes sense to call <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#close()">close()</a></code> on the <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> immediately after accepting a connected
socket.</p> 
</li> 
</ol> 
 
<p>The <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#accept()">accept()</a></code> call should not
be executed in the main activity UI thread because it is a blocking call and
will prevent any other interaction with the application. It usually makes
sense to do all work with a <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> or <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> in a new
thread managed by your application. To abort a blocked call such as <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#accept()">accept()</a></code>, call <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#close()">close()</a></code> on the <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> (or <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>) from another thread and the blocked call will
immediately return. Note that all methods on a <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> or <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>
are thread-safe.</p> 
 
<h4>Example</h4> 
 
<p>Here's a simplified thread for the server component that accepts incoming
connections:</p> 
<pre> 
private class AcceptThread extends Thread {
    private final 蓝牙ServerSocket mmServerSocket;
 
    public AcceptThread() {
        // Use a temporary object that is later assigned to mmServerSocket,
        // because mmServerSocket is final
        蓝牙ServerSocket tmp = null;
        try {
            // MY_UUID is the app's UUID string, also used by the client code
            tmp = m蓝牙Adapter.listenUsingRfcommWithServiceRecord(NAME, MY_UUID);
        } catch (IOException e) { }
        mmServerSocket = tmp;
    }
 
    public void run() {
        蓝牙Socket socket = null;
        // Keep listening until exception occurs or a socket is returned
        while (true) {
            try {
                socket = mmServerSocket.accept();
            } catch (IOException e) {
                break;
            }
            // If a connection was accepted
            if (socket != null) {
                // Do work to manage the connection (in a separate thread)
                manageConnectedSocket(socket);
                mmServerSocket.close();
                break;
            }
        }
    }
 
    /** Will cancel the listening socket, and cause the thread to finish */
    public void cancel() {
        try {
            mmServerSocket.close();
        } catch (IOException e) { }
    }
}
</pre> 
 
<p>In this example, only one incoming connection is desired, so as soon as a
connection is accepted and the <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> is
acquired, the application
sends the acquired <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> to a separate
thread, closes the
<code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> and breaks the loop.</p> 
 
<p>Note that when <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#accept()">accept()</a></code>
returns the <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>, the socket is already
connected, so you should <em>not</em> call <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#connect()">connect()</a></code> (as you do from the
client-side).</p> 
 
<p><code>manageConnectedSocket()</code> is a fictional method in the application
that will
initiate the thread for transferring data, which is discussed in the section
about <a href="#ManagingAConnection">Managing a Connection</a>.</p> 
 
<p>You should usually close your <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code>
as soon as you are done listening for incoming connections. In this example, <code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html#close()">close()</a></code> is called as soon
as the <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> is acquired. You may also want
to provide a public method in your thread that can close the private <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> in the event that you need to stop listening on the
server socket.</p> 
 
 
<h3 id="ConnectingAsAClient">Connecting as a client</h3> 
 
<p>In order to initiate a connection with a remote device (a device holding an
open
server socket), you must first obtain a <code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code> object that represents the remote device.
(Getting a <code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code> is covered in the above
section about <a
href="#FindingDevices">Finding Devices</a>.) You must then use the
<code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code> to acquire a <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> and initiate the connection.</p> 
 
<p>Here's the basic procedure:</p> 
 
<ol> 
<li>Using the <code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code>, get a <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> by calling <code><a href="../../../reference/android/bluetooth/蓝牙Device.html#createRfcommSocketToServiceRecord(java.util.UUID)">createRfcommSocketToServiceRecord(UUID)</a></code>.
<p>This initializes a <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code> that will
connect to the <code><a href="../../../reference/android/bluetooth/蓝牙Device.html">蓝牙Device</a></code>. The UUID passed here
must match the UUID used by the server device when it opened its
<code><a href="../../../reference/android/bluetooth/蓝牙ServerSocket.html">蓝牙ServerSocket</a></code> (with <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#listenUsingRfcommWithServiceRecord(java.lang.String, java.util.UUID)">listenUsingRfcommWithServiceRecord(String, UUID)</a></code>). Using the same UUID is simply a matter of hard-coding the UUID string
into your application and then referencing it from both the server and client
code.</p> 
</li> 
 
<li>Initiate the connection by calling <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#connect()">connect()</a></code>.
<p>Upon this call, the system will perform an SDP lookup on the remote device in
order to match the UUID. If the lookup is successful and the remote device
accepts the connection, it will share the RFCOMM channel to use during the
connection and <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#connect()">connect()</a></code> will return. This method is a
blocking call. If, for
any reason, the connection fails or the <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#connect()">connect()</a></code> method times out (after about
12 seconds), then it will throw an exception.</p> 
<p>Because <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#connect()">connect()</a></code> is a blocking call, this connection
procedure should always be performed in a thread separate from the main activity
thread.</p> 
<p class="note">Note: You should always ensure that the device is not performing
device discovery when you call <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#connect()">connect()</a></code>. If discovery is in progress, then
the
connection attempt will be significantly slowed and is more likely to fail.</p> 
</li> 
</ol> 
 
<h4>Example</h4> 
 
<p>Here is a basic example of a thread that initiates a 蓝牙
connection:</p> 
<pre> 
private class ConnectThread extends Thread {
    private final 蓝牙Socket mmSocket;
    private final 蓝牙Device mmDevice;
 
    public ConnectThread(蓝牙Device device) {
        // Use a temporary object that is later assigned to mmSocket,
        // because mmSocket is final
        蓝牙Socket tmp = null;
        mmDevice = device;
 
        // Get a 蓝牙Socket to connect with the given 蓝牙Device
        try {
            // MY_UUID is the app's UUID string, also used by the server code
            tmp = device.createRfcommSocketToServiceRecord(MY_UUID);
        } catch (IOException e) { }
        mmSocket = tmp;
    }
 
    public void run() {
        // Cancel discovery because it will slow down the connection
        m蓝牙Adapter.cancelDiscovery();
 
        try {
            // Connect the device through the socket. This will block
            // until it succeeds or throws an exception
            mmSocket.connect();
        } catch (IOException connectException) {
            // Unable to connect; close the socket and get out
            try {
                mmSocket.close();
            } catch (IOException closeException) { }
            return;
        }
 
        // Do work to manage the connection (in a separate thread)
        manageConnectedSocket(mmSocket);
    }
 
    /** Will cancel an in-progress connection, and close the socket */
    public void cancel() {
        try {
            mmSocket.close();
        } catch (IOException e) { }
    }
}
</pre> 
 
<p>Notice that <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#cancelDiscovery()">cancelDiscovery()</a></code> is called
before the connection is made. You should always do this before connecting and it is safe
to call without actually checking whether it is running or not (but if you do want to
check, call <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#isDiscovering()">isDiscovering()</a></code>).</p> 
 
<p><code>manageConnectedSocket()</code> is a fictional method in the application
that will initiate the thread for transferring data, which is discussed in the section
about <a href="#ManagingAConnection">Managing a Connection</a>.</p> 
 
<p>When you're done with your <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>, always
call <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#close()">close()</a></code> to clean up.
Doing so will immediately close the connected socket and clean up all internal
resources.</p> 
 
 
<h2 id="ManagingAConnection">Managing a Connection</h2> 
 
<p>When you have successfully connected two (or more) devices, each one will
have a connected <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>. This is where the fun
begins because you can share data between devices. Using the <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>, the general procedure to transfer arbitrary data is
simple:</p> 
<ol> 
<li>Get the <code><a href="../../../reference/java/io/InputStream.html">InputStream</a></code> and <code><a href="../../../reference/java/io/OutputStream.html">OutputStream</a></code> that
handle transmissions through the socket, via <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#getInputStream()">getInputStream()</a></code> and
<code><a href="../../../reference/android/bluetooth/蓝牙Socket.html#getOutputStream()">getOutputStream()</a></code>, respectively.</li> 
 
<li>Read and write data to the streams with <code><a href="../../../reference/java/io/InputStream.html#read(byte[])">read(byte[])</a></code> and <code><a href="../../../reference/java/io/OutputStream.html#write(byte[])">write(byte[])</a></code>.</li> 
</ol> 
 
<p>That's it.</p> 
 
<p>There are, of course, implementation details to consider. First and foremost,
you should use a dedicated thread for all stream reading and writing. This is
important because both <code><a href="../../../reference/java/io/InputStream.html#read(byte[])">read(byte[])</a></code> and <code><a href="../../../reference/java/io/OutputStream.html#write(byte[])">write(byte[])</a></code> methods are blocking calls. <code><a href="../../../reference/java/io/InputStream.html#read(byte[])">read(byte[])</a></code> will block until there is something to read
from the stream. <code><a href="../../../reference/java/io/OutputStream.html#write(byte[])">write(byte[])</a></code> does not usually
block, but can block for flow control if the remote device is not calling <code><a href="../../../reference/java/io/InputStream.html#read(byte[])">read(byte[])</a></code> quickly enough and the intermediate buffers are full.
So, your main loop in the thread should be dedicated to reading from the <code><a href="../../../reference/java/io/InputStream.html">InputStream</a></code>. A separate public method in the thread can be used to initiate
writes to the <code><a href="../../../reference/java/io/OutputStream.html">OutputStream</a></code>.</p> 
 
<h4>Example</h4> 
 
<p>Here's an example of how this might look:</p> 
<pre> 
private class ConnectedThread extends Thread {
    private final 蓝牙Socket mmSocket;
    private final InputStream mmInStream;
    private final OutputStream mmOutStream;
 
    public ConnectedThread(蓝牙Socket socket) {
        mmSocket = socket;
        InputStream tmpIn = null;
        OutputStream tmpOut = null;
 
        // Get the input and output streams, using temp objects because
        // member streams are final
        try {
            tmpIn = socket.getInputStream();
            tmpOut = socket.getOutputStream();
        } catch (IOException e) { }
 
        mmInStream = tmpIn;
        mmOutStream = tmpOut;
    }
 
    public void run() {
        byte[] buffer = new byte[1024];  // buffer store for the stream
        int bytes; // bytes returned from read()
 
        // Keep listening to the InputStream until an exception occurs
        while (true) {
            try {
                // Read from the InputStream
                bytes = mmInStream.read(buffer);
                // Send the obtained bytes to the UI activity
                mHandler.obtainMessage(MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget();
            } catch (IOException e) {
                break;
            }
        }
    }
 
    /* Call this from the main activity to send data to the remote device */
    public void write(byte[] bytes) {
        try {
            mmOutStream.write(bytes);
        } catch (IOException e) { }
    }
 
    /* Call this from the main activity to shutdown the connection */
    public void cancel() {
        try {
            mmSocket.close();
        } catch (IOException e) { }
    }
}
</pre> 
 
<p>The constructor acquires the necessary streams and once executed, the thread
will wait for data to come through the InputStream. When <code><a href="../../../reference/java/io/InputStream.html#read(byte[])">read(byte[])</a></code> returns with
bytes from the stream, the data is sent to the main activity using a member
Handler from the parent class. Then it goes back and waits for more bytes from
the stream.</p> 
 
<p>Sending outgoing data is as simple as calling the thread's
<code>write()</code> method from the main activity and passing in the bytes to
be sent. This method then simply calls <code><a href="../../../reference/java/io/OutputStream.html#write(byte[])">write(byte[])</a></code> to send the data to the remote device.</p> 
 
<p>The thread's <code>cancel()</code> method is important so that the connection
can be
terminated at any time by closing the <code><a href="../../../reference/android/bluetooth/蓝牙Socket.html">蓝牙Socket</a></code>.
This should always be called when you're done using the 蓝牙
connection.</p> 
 
<div class="special"> 
<p>For a  demonstration of using the 蓝牙 APIs, see the <a
href="../../../resources/samples/蓝牙Chat/index.html">蓝牙 Chat sample app</a>.</p> 
</div> 

<h2 id="Profiles">Working with Profiles</h2> 

<p>Starting in Android 3.0, the 蓝牙 API includes support for working with
蓝牙 profiles. A <em>蓝牙 profile</em> is a wireless interface
specification for 蓝牙-based communication between devices. An example
is the Hands-Free profile. For a mobile phone to connect to a wireless headset,
both devices must support the Hands-Free profile. </p> 

<p>You can implement the interface <code><a href="../../../reference/android/bluetooth/蓝牙Profile.html">蓝牙Profile</a></code> to write
your own classes to support a particular 蓝牙 profile. The Android
蓝牙 API provides implementations for the following 蓝牙
profiles:</p> 
<ul> 

  <li><strong>Headset</strong>. The Headset profile provides support for
蓝牙 headsets to be used with mobile phones. Android provides the <code><a href="../../../reference/android/bluetooth/蓝牙Headset.html">蓝牙Headset</a></code> class, which is a proxy for controlling the
蓝牙 Headset Service via interprocess communication (<a
href="../../../guide/components/processes-and-threads.html#IPC">IPC</a
>). This includes both  蓝牙 Headset and Hands-Free (v1.5) profiles. The
<code><a href="../../../reference/android/bluetooth/蓝牙Headset.html">蓝牙Headset</a></code> class includes support for AT commands.
For more discussion of this topic, see <a href="#AT-Commands">Vendor-specific AT commands</a></li>

  <li><strong>A2DP</strong>. The Advanced Audio Distribution Profile (A2DP)
profile defines how high quality audio can be streamed from one device to
another over a 蓝牙 connection. Android provides the <code><a href="../../../reference/android/bluetooth/蓝牙A2dp.html">蓝牙A2dp</a></code> class, which is a proxy for controlling
the 蓝牙 A2DP  Service via IPC.</li> 

 <li><strong>Health Device</strong>. Android 4.0 (API level 14) introduces
support for the 蓝牙 Health Device Profile (HDP). This lets you create
applications that use 蓝牙 to communicate with health devices that support
蓝牙, such as heart-rate monitors, blood meters, thermometers, scales, and
so on. For a list of supported devices and their corresponding device data
specialization codes, refer to <strong>蓝牙 Assigned Numbers</strong> at <a
href="http://www.bluetooth.org">www.bluetooth.org</a>. Note that these values
are also referenced in the ISO/IEEE 11073-20601 [7] specification as
MDC_DEV_SPEC_PROFILE_* in the Nomenclature Codes Annex. For more discussion of
HDP, see <a href="#HDP">Health Device Profile</a>.</li> 

</ul> 

<p>Here are the basic steps for working with a profile:</p> 
<ol> 

  <li>Get the default adapter, as described in
    <a href="../../../guide/topics/connectivity/bluetooth.html#SettingUp">Setting Up
      蓝牙</a>.</li> 

  <li>Use <code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#getProfileProxy(android.content.Context, android.bluetooth.蓝牙Profile.ServiceListener, int)">getProfileProxy()</a></code> to
establish a connection to the profile proxy object associated with the profile.
In the example below, the profile proxy object is an instance of <code><a href="../../../reference/android/bluetooth/蓝牙Headset.html">蓝牙Headset</a></code>. </li> 

  <li>Set up a  <code><a href="../../../reference/android/bluetooth/蓝牙Profile.ServiceListener.html">蓝牙Profile.ServiceListener</a></code>. This
listener notifies <code><a href="../../../reference/android/bluetooth/蓝牙Profile.html">蓝牙Profile</a></code> IPC clients when
they have been connected to or disconnected from the service.</li> 

  <li>In <code><a href="../../../reference/android/bluetooth/蓝牙Profile.ServiceListener.html#onServiceConnected(int, android.bluetooth.蓝牙Profile)">onServiceConnected()</a></code>, get a handle
to the profile proxy object.</li> 

  <li>Once you have the profile proxy object, you can use it to monitor the
state of the connection and perform other operations that are relevant to that
profile.</li> 
</ol> 

<p> For example, this code snippet shows how to connect to a <code><a href="../../../reference/android/bluetooth/蓝牙Headset.html">蓝牙Headset</a></code> proxy object so that you can control the
Headset profile:</p> 

<pre>蓝牙Headset m蓝牙Headset;
 
// Get the default adapter
蓝牙Adapter m蓝牙Adapter = 蓝牙Adapter.getDefaultAdapter();
 
// Establish connection to the proxy.
m蓝牙Adapter.getProfileProxy(context, mProfileListener, 蓝牙Profile.HEADSET);
 
private 蓝牙Profile.ServiceListener mProfileListener = new 蓝牙Profile.ServiceListener() {
    public void onServiceConnected(int profile, 蓝牙Profile proxy) {
        if (profile == 蓝牙Profile.HEADSET) {
            m蓝牙Headset = (蓝牙Headset) proxy;
        }
    }
    public void onServiceDisconnected(int profile) {
        if (profile == 蓝牙Profile.HEADSET) {
            m蓝牙Headset = null;
        }
    }
};
 
// ... call functions on m蓝牙Headset
 
// Close proxy connection after use.
m蓝牙Adapter.closeProfileProxy(m蓝牙Headset);
</pre> 



<h3 id="AT-Commands">Vendor-specific AT commands</h3> 

<p>Starting in Android 3.0, applications can register to receive system
broadcasts of pre-defined vendor-specific AT commands sent by headsets (such as
a Plantronics +XEVENT command). For example, an application could receive
broadcasts that indicate a connected device's battery level and could notify the
user or take other action as needed. Create a broadcast receiver for the <code><a href="../../../reference/android/bluetooth/蓝牙Headset.html#ACTION_VENDOR_SPECIFIC_HEADSET_EVENT">ACTION_VENDOR_SPECIFIC_HEADSET_EVENT</a></code> intent
to handle vendor-specific AT commands for the headset.</p>

<h3 id="HDP">Health Device Profile</h3>

<p>Android 4.0 (API level 14) introduces support for the 蓝牙 Health Device
Profile (HDP). This lets you create applications that use 蓝牙 to
communicate with health devices that support 蓝牙, such as heart-rate
monitors, blood meters, thermometers, and scales. The 蓝牙 Health API
includes the classes <code><a href="../../../reference/android/bluetooth/蓝牙Health.html">蓝牙Health</a></code>, <code><a href="../../../reference/android/bluetooth/蓝牙HealthCallback.html">蓝牙HealthCallback</a></code>, and <code><a href="../../../reference/android/bluetooth/蓝牙HealthAppConfiguration.html">蓝牙HealthAppConfiguration</a></code>, which are described in <a
href="#TheBasics">The Basics</a>. </p>

<p>In using the 蓝牙 Health API, it's helpful to understand these key HDP concepts:</p>
<table>
  <tr>
    <th>Concept</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><strong>Source</strong></td>

    <td>A role defined in HDP. A <em>source</em> is a  health device that
transmits medical data (weight scale, glucose meter, thermometer, etc.) to a
smart device such as an Android phone or tablet. </td>
  </tr>
  <tr>
    <td><strong>Sink</strong></td>

    <td>A role defined in HDP. In HDP, a <em>sink</em> is the smart device that
receives the medical data. In an Android HDP application, the sink is
represented by a <code><a href="../../../reference/android/bluetooth/蓝牙HealthAppConfiguration.html">蓝牙HealthAppConfiguration</a></code>
object.</td>
  </tr>
  <tr>
    <td><strong>Registration</strong></td>
    <td>Refers to registering a sink for a particular health device.</td>
  </tr>
  <tr>
    <td><strong>Connection</strong></td>

    <td>Refers to opening a channel between a health device and a smart device
such as an Android phone or tablet.</td>
  </tr>
</table>

<h4>Creating an HDP Application</h4>

<p>Here are the basic steps involved in creating an Android HDP application:</p>
<ol>

  <li>Get a reference to the <code><a href="../../../reference/android/bluetooth/蓝牙Health.html">蓝牙Health</a></code> proxy
object. <p>Similar to regular headset and A2DP profile devices, you must call
<code><a href="../../../reference/android/bluetooth/蓝牙Adapter.html#getProfileProxy(android.content.Context, android.bluetooth.蓝牙Profile.ServiceListener, int)">getProfileProxy()</a></code>
with a <code><a href="../../../reference/android/bluetooth/蓝牙Profile.ServiceListener.html">蓝牙Profile.ServiceListener</a></code> and the <code><a href="../../../reference/android/bluetooth/蓝牙Profile.html#HEALTH">HEALTH</a></code> profile type to
establish a connection with the profile proxy object.</p> </li>

  <li>Create a <code><a href="../../../reference/android/bluetooth/蓝牙HealthCallback.html">蓝牙HealthCallback</a></code> and register an
application configuration 
(<code><a href="../../../reference/android/bluetooth/蓝牙HealthAppConfiguration.html">蓝牙HealthAppConfiguration</a></code>)
that acts as a health
sink.</li>

  <li>Establish a connection to a health device.  Some devices will initiate the
connection.  It is unnecessary to carry out this step for those devices.</li>

  <li>When connected successfully to a health device, read/write to the health
device using the file descriptor. <p>The received data needs to be interpreted
using a health manager which implements the IEEE 11073-xxxxx
specifications.</p></li>

  <li>When done, close the health channel and unregister the application.  The
channel also closes when there is extended inactivity.</li>
</ol>

<p>For a complete code sample that illustrates these steps, see <a
href="../../../resources/samples/蓝牙HDP/index.html">蓝牙 HDP (Health
Device Profile)</a>. </p>

    </div>
      
      <div class="content-footer layout-content-row" 
                    itemscope itemtype="http://schema.org/SiteNavigationElement">
        <div class="layout-content-col col-8" style="padding-top:4px">
          
            <div class="g-plusone" data-size="medium"></div>
          
        </div>
        
        <div class="paging-links layout-content-col col-4">
          
            <a href="#" class="prev-page-link hide"
                zh-TW-lang="上一堂課"
                zh-CN-lang="上一课"
                ru-lang="Предыдущий"
                ko-lang="이전"
                ja-lang="前へ"
                es-lang="Anterior"               
                >上一堂课</a>
            <a href="#" class="next-page-link hide"
                zh-TW-lang="下一堂課"
                zh-CN-lang="下一课"
                ru-lang="Следующий"
                ko-lang="다음"
                ja-lang="次へ"
                es-lang="Siguiente"               
                >下一堂课</a>
          
        </div>
        
      </div>
      
      
      

  </div> <!-- end jd-content -->

<div id="footer" class="wrap" >
        

  <div id="copyright">
    
  除非有特别提醒，本文档受 <a
  href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a>. 
  For details and <a href="../../../license.html">
  Content License</a>。
  </div>
  <div id="build_info">
    
  Android 4.2&nbsp;r1 - 13 Nov 2012  0:25

  </div>


  <div id="footerlinks">
    
  <p>
    <a href="../../../about/index.html">About Android</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../../legal.html">Legal</a>&nbsp;&nbsp;|&nbsp;
    <a href="../../../support.html">Support</a>
  </p>
  </div>

</div> <!-- end footer -->
</div><!-- end doc-content -->

</div> <!-- end body-content --> 




<!-- Grid - for dev 
<script type="text/javascript">

window.gOverride = {
		gColor: '#FF0000',
		pColor: '#EEEEEE',
		gOpacity: 0.10,
		pOpacity: 0.40,
		pHeight: 16,
		pOffset: 2,
		gColumns:16,
		gEnabled:false,
		pEnabled:false
	}
</script>
	
<link href="../../../assets/js/grid/960.gridder.css" rel="stylesheet" type="text/css">
<script src="../../../assets/js/grid/960.gridder.js" type="text/javascript"></script>
-->





<script type="text/javascript">
init(); /* initialize android-developer-docs.js */
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
  var pageTracker = _gat._getTracker("UA-5831155-1");
  pageTracker._trackPageview();
</script>



</body>
</html>



